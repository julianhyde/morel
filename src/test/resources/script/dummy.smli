(*
 * Licensed to Julian Hyde under one or more contributor license
 * agreements.  See the NOTICE file distributed with this work
 * for additional information regarding copyright ownership.
 * Julian Hyde licenses this file to you under the Apache
 * License, Version 2.0 (the "License"); you may not use this
 * file except in compliance with the License.  You may obtain a
 * copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
 * either express or implied.  See the License for the specific
 * language governing permissions and limitations under the
 * License.
 *)
"this is a simple script; modify it for debugging test cases";
> val it = "this is a simple script; modify it for debugging test cases" : string

val emps =
  [{deptno=10,id=100,name="Fred"},{deptno=20,id=101,name="Velma"},
   {deptno=30,id=102,name="Shaggy"},{deptno=30,id=103,name="Scooby"}]
  : {deptno:int, id:int, name:string} list;
> val emps =
>   [{deptno=10,id=100,name="Fred"},{deptno=20,id=101,name="Velma"},
>    {deptno=30,id=102,name="Shaggy"},{deptno=30,id=103,name="Scooby"}]
>   : {deptno:int, id:int, name:string} list

from e in emps
  group {e.deptno, parity = e.deptno mod 2}
    compute {sumId = sum over e.id};
> val it =
>   [{deptno=30,parity=0,sumId=205},{deptno=10,parity=0,sumId=100},
>    {deptno=20,parity=0,sumId=101}] : {deptno:int, parity:int, sumId:int} list

from e in [{deptno=10}]
  group {e.deptno, parity = e.deptno mod 2}
    compute {sumId = sum over e.deptno}
  group {parity}
    compute {sumSumId = sum over sumId,
      c = count over ()};
> val it = [{c=1,parity=0,sumSumId=10}] : {c:int, parity:int, sumSumId:int} list

(*) Group followed by group
from e in emps
  group {e.deptno, parity = e.deptno mod 2}
    compute {sumId = sum over e.id}
  group parity
    compute {sumSumId = sum over sumId,
      c = count over ()};
> val it = [{c=3,parity=0,sumSumId=406}] : {c:int, parity:int, sumSumId:int} list

    from e in emps
    group {deptno = #deptno e}
      compute {sumId = sum over #id e};
> val it = [{deptno=20,sumId=101},{deptno=10,sumId=100},{deptno=30,sumId=205}]
>   : {deptno:int, sumId:int} list

    from e in emps
      group {deptno = #deptno e}
        compute {sumId = sum over #id e};
> val it = [{deptno=20,sumId=101},{deptno=10,sumId=100},{deptno=30,sumId=205}]
>   : {deptno:int, sumId:int} list

(*) End dummy.smli
